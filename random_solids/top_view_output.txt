[32;1m
*******************************************************************
******        Statistics on Transfer (Write)                 ******[0m
[32;1m
*******************************************************************
******        Transfer Mode = 0  I.E.  As Is       ******[0m
[32;1m******        Transferring Shape, ShapeType = 0                      ******[0m
[32;1m** WorkSession : Sending all data[0m
[32;1m Step File Name : solid_output.step(978 ents)  Write  Done[0m
[DEBUG] Starting main() function.
Creating base cuboid (40x30x20)...
Base Cuboid Tag: None
Slot Cuboid Tag: None
Hole Cuboid Tag: None
Creating base cuboid (40x30x20)...
Creating slot on top face...
  Slot: 25.0x6.0x8.0 at position (0, 12.0, 12.0)
Creating square blind hole...
  Blind hole: 5.0x5.0x12.0 at position (17.5, 12.5, 0)
Performing boolean CUT operations...
  ✓ Slot cut successfully
  ✓ Blind hole cut successfully
  Shape validation:
    Shells: 1
    Faces: 14
    Edges: 72
    ✓ Shape validation passed
✓ Created complex solid with slot and blind hole:
  Base cuboid: 40 x 30 x 20
  Top slot: 25.0 x 6.0 x 8.0 (from left edge)
  Blind hole: 5.0 x 5.0 x 12.0 (centered, from bottom)
  Boolean operations: CUT (SUBTRACT) x2
  Operation completed successfully with proper error checking
  Shape validation: PASSED
[DEBUG] Solid created: <class 'OCC.Core.TopoDS.TopoDS_Compound'>
✓ STEP file saved as 'solid_output.step'

============================================================
3D SOLID VISUALIZATION WITH MATPLOTLIB
============================================================
  → Extracting face vertices for 3D plot...
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,20.0)
              Edge 1: vertex (0.0,12.0,20.0)
              Edge 2: vertex (0.0,12.0,12.0)
              Edge 3: vertex (0.0,18.0,12.0)
              Edge 4: vertex (0.0,18.0,20.0)
              Edge 5: vertex (0.0,30.0,20.0)
              Edge 6: vertex (0.0,30.0,0.0)
              Edge 7: vertex (0.0,0.0,0.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,20.0) → (0.0,12.0,20.0) → (0.0,12.0,12.0) → (0.0,18.0,12.0) → (0.0,18.0,20.0) → (0.0,30.0,20.0) → (0.0,30.0,0.0) → (0.0,0.0,0.0) → (0.0,0.0,20.0)
    Face 1: 9 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,12.0,20.0)
              Edge 1: vertex (0.0,0.0,20.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
              Edge 4: vertex (0.0,30.0,20.0)
              Edge 5: vertex (0.0,18.0,20.0)
              Edge 6: vertex (25.0,18.0,20.0)
              Edge 7: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,12.0,20.0) → (0.0,0.0,20.0) → (40.0,0.0,20.0) → (40.0,30.0,20.0) → (0.0,30.0,20.0) → (0.0,18.0,20.0) → (25.0,18.0,20.0) → (25.0,12.0,20.0) → (0.0,12.0,20.0)
    Face 2: 9 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (0.0,12.0,20.0)
              Edge 3: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (0.0,12.0,12.0) → (0.0,12.0,20.0) → (25.0,12.0,20.0) → (25.0,12.0,12.0)
    Face 3: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (25.0,12.0,12.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (0.0,12.0,12.0) → (25.0,12.0,12.0) → (25.0,18.0,12.0) → (0.0,18.0,12.0)
    Face 4: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (25.0,18.0,12.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (0.0,18.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (25.0,18.0,12.0) → (25.0,18.0,20.0) → (0.0,18.0,20.0) → (0.0,18.0,12.0)
    Face 5: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,30.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (0.0,30.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,30.0,0.0) → (0.0,30.0,0.0) → (0.0,30.0,20.0) → (40.0,30.0,20.0) → (40.0,30.0,0.0)
    Face 6: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,0.0,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (0.0,30.0,0.0) → (40.0,30.0,0.0) → (40.0,0.0,0.0) → (0.0,0.0,0.0)
    Face 7: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (0.0,0.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (40.0,0.0,0.0) → (40.0,0.0,20.0) → (0.0,0.0,20.0) → (0.0,0.0,0.0)
    Face 8: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (25.0,12.0,20.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (25.0,12.0,20.0) → (25.0,18.0,20.0) → (25.0,18.0,12.0) → (25.0,12.0,12.0)
    Face 9: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,0.0,20.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,0.0,20.0) → (40.0,0.0,0.0) → (40.0,30.0,0.0) → (40.0,30.0,20.0) → (40.0,0.0,20.0)
    Face 10: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,17.5,0.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,12.5,0.0) → (17.5,17.5,0.0) → (17.5,17.5,12.0) → (17.5,12.5,12.0)
    Face 11: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,12.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (17.5,12.5,0.0) → (17.5,12.5,12.0) → (22.5,12.5,12.0) → (22.5,12.5,0.0)
    Face 12: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (22.5,12.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (22.5,12.5,12.0) → (22.5,17.5,12.0) → (22.5,17.5,0.0) → (22.5,12.5,0.0)
    Face 13: 5 vertices extracted
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (22.5,17.5,0.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (22.5,17.5,0.0) → (22.5,17.5,12.0) → (17.5,17.5,12.0) → (17.5,17.5,0.0)
    Face 14: 5 vertices extracted
  → Successfully extracted 14 faces for visualization
✓ 3D solid visualization complete - POLYGON BOUNDARIES ONLY
  → Displayed 14 faces as pure polygons
  → NO triangulation applied to any face
  → Face 3 should appear as 5-vertex pentagon with inclined edge
  → Total vertices plotted: 78
[DEBUG] Projection normal: [0.55708601 0.37139068 0.74278135]
  Traversing BRep topology: Solid -> Shells -> Faces -> Wires -> Edges -> Vertices
  Found 1 shells in solid
  
Shell 1:
    Face 1:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (0.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 1
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,20.0)
              Edge 1: vertex (0.0,12.0,20.0)
              Edge 2: vertex (0.0,12.0,12.0)
              Edge 3: vertex (0.0,18.0,12.0)
              Edge 4: vertex (0.0,18.0,20.0)
              Edge 5: vertex (0.0,30.0,20.0)
              Edge 6: vertex (0.0,30.0,0.0)
              Edge 7: vertex (0.0,0.0,0.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,20.0) → (0.0,12.0,20.0) → (0.0,12.0,12.0) → (0.0,18.0,12.0) → (0.0,18.0,20.0) → (0.0,30.0,20.0) → (0.0,30.0,0.0) → (0.0,0.0,0.0) → (0.0,0.0,20.0)
        Co-linearity Analysis for Face 1:
          Co-linear vertices found: 7-8-0
            V7: (0.000, 0.000, 0.000)
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            V1: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ Z-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 2:
        Face orientation: 0
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 20.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 1 wires in face 2
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,12.0,20.0)
              Edge 1: vertex (0.0,0.0,20.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
              Edge 4: vertex (0.0,30.0,20.0)
              Edge 5: vertex (0.0,18.0,20.0)
              Edge 6: vertex (25.0,18.0,20.0)
              Edge 7: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,12.0,20.0) → (0.0,0.0,20.0) → (40.0,0.0,20.0) → (40.0,30.0,20.0) → (0.0,30.0,20.0) → (0.0,18.0,20.0) → (25.0,18.0,20.0) → (25.0,12.0,20.0) → (0.0,12.0,20.0)
        Co-linearity Analysis for Face 2:
          Co-linear vertices found: 7-8-0
            V7: (25.000, 12.000, 20.000)
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            V1: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ X-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 3:
        Face orientation: 0
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 12.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 3
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (0.0,12.0,20.0)
              Edge 3: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (0.0,12.0,12.0) → (0.0,12.0,20.0) → (25.0,12.0,20.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 3:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 12.000, 20.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 4:
        Face orientation: 0
        Parameter bounds: U[0.000, 25.000], V[0.000, 6.000]
        Using parameters: U=12.500, V=3.000
        Surface point: (12.500, 15.000, 12.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 2 wires in face 4
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (25.0,12.0,12.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (0.0,12.0,12.0) → (25.0,12.0,12.0) → (25.0,18.0,12.0) → (0.0,18.0,12.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,17.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,17.5,12.0) → (22.5,17.5,12.0) → (22.5,12.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 4:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 5:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 18.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 5
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (25.0,18.0,12.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (0.0,18.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (25.0,18.0,12.0) → (25.0,18.0,20.0) → (0.0,18.0,20.0) → (0.0,18.0,12.0)
        Co-linearity Analysis for Face 5:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 18.000, 20.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (25.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 6:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 30.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 6
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,30.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (0.0,30.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,30.0,0.0) → (0.0,30.0,0.0) → (0.0,30.0,20.0) → (40.0,30.0,20.0) → (40.0,30.0,0.0)
        Co-linearity Analysis for Face 6:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 7:
        Face orientation: 1
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 0.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-0.000000, -0.000000, -1.000000]
      Found 2 wires in face 7
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,0.0,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (0.0,30.0,0.0) → (40.0,30.0,0.0) → (40.0,0.0,0.0) → (0.0,0.0,0.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (22.5,12.5,0.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (17.5,12.5,0.0) → (22.5,12.5,0.0) → (22.5,17.5,0.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 7:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 0.000, 0.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 8:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 0.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 8
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (0.0,0.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (40.0,0.0,0.0) → (40.0,0.0,20.0) → (0.0,0.0,20.0) → (0.0,0.0,0.0)
        Co-linearity Analysis for Face 8:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 0.000, 20.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 9:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[-6.000, 0.000]
        Using parameters: U=4.000, V=-3.000
        Surface point: (25.000, 15.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 9
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (25.0,12.0,20.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (25.0,12.0,20.0) → (25.0,18.0,20.0) → (25.0,18.0,12.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 9:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (25.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 10:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (40.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 10
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,0.0,20.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,0.0,20.0) → (40.0,0.0,0.0) → (40.0,30.0,0.0) → (40.0,30.0,20.0) → (40.0,0.0,20.0)
        Co-linearity Analysis for Face 10:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 11:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (17.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 11
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,17.5,0.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,12.5,0.0) → (17.5,17.5,0.0) → (17.5,17.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 11:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 12:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 12.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 12
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,12.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (17.5,12.5,0.0) → (17.5,12.5,12.0) → (22.5,12.5,12.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 12:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 12.500, 12.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 13:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (22.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 13
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (22.5,12.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (22.5,12.5,12.0) → (22.5,17.5,12.0) → (22.5,17.5,0.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 13:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 17.500, 0.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (22.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 14:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 17.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 14
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (22.5,17.5,0.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (22.5,17.5,0.0) → (22.5,17.5,12.0) → (17.5,17.5,12.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 14:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            V1: (22.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
  
✓ Successfully extracted 14 faces from 1 shells

============================================================
ENHANCED FACE CLASSIFICATION WITH HISTORIC ALGORITHM
============================================================
Unit projection normal: [0.557086, 0.371391, 0.742781]

Step 1: Initial classification and polygon projection...
Face F1: dot_product=-0.557
    → Creating polygon from 9 vertices
    → Valid polygon created with 8 vertices
  → Added Face_1 (area: 307.51)
Face F2: dot_product=0.743
    → Creating polygon from 9 vertices
    → Valid polygon created with 8 vertices
  → Added Face_2 (area: 779.92)
Face F3: dot_product=0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_3 (area: 74.28)
Face F4: dot_product=0.743
  → Added Face_4 (area: 92.85) with 1 holes
Face F5: dot_product=-0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_5 (area: 74.28)
Face F6: dot_product=0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_6 (area: 297.11)
Face F7: dot_product=-0.743
  → Added Face_7 (area: 872.77) with 1 holes
Face F8: dot_product=-0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_8 (area: 297.11)
Face F9: dot_product=-0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_9 (area: 26.74)
Face F10: dot_product=0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_10 (area: 334.25)
Face F11: dot_product=0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_11 (area: 33.43)
Face F12: dot_product=0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_12 (area: 22.28)
Face F13: dot_product=-0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_13 (area: 33.43)
Face F14: dot_product=-0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_14 (area: 22.28)

Step 2: Starting historic polygon classification algorithm...
Initial array_A: 14 polygons

============================================================
ARRAY A - INITIAL FACE CLASSIFICATION (BEFORE SORTING)
============================================================
  Face A1 (Face_1):
    • Area: 307.51
    • Vertices: 8
    • Dot product: -0.557086
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (-10.0,-8.9) → (-13.0,1.8) → (-9.0,5.4) → (-10.5,10.7) → (-14.4,7.2) → (-17.4,17.9) → (-7.5,26.8) → (0.0,0.0)
  Face A2 (Face_2):
    • Area: 779.92
    • Vertices: 8
    • Dot product: 0.742781
    • Face normal: [0.000, 0.000, 1.000]
    • 2D Polygon: (-13.0,1.8) → (-10.0,-8.9) → (23.3,-8.9) → (15.8,17.9) → (-17.4,17.9) → (-14.4,7.2) → (6.3,7.2) → (7.8,1.8)
  Face A3 (Face_3):
    • Area: 74.28
    • Vertices: 4
    • Dot product: 0.371391
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (11.8,5.4) → (-9.0,5.4) → (-13.0,1.8) → (7.8,1.8)
  Face A4 (Face_4):
    • Area: 92.85
    • Vertices: 4
    • Dot product: 0.742781
    • Face normal: [0.000, 0.000, 1.000]
    • 2D Polygon: (-10.5,10.7) → (-9.0,5.4) → (11.8,5.4) → (10.3,10.7)
  Face A5 (Face_5):
    • Area: 74.28
    • Vertices: 4
    • Dot product: -0.371391
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (-10.5,10.7) → (10.3,10.7) → (6.3,7.2) → (-14.4,7.2)
  Face A6 (Face_6):
    • Area: 297.11
    • Vertices: 4
    • Dot product: 0.371391
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (25.7,26.8) → (-7.5,26.8) → (-17.4,17.9) → (15.8,17.9)
  Face A7 (Face_7):
    • Area: 872.77
    • Vertices: 4
    • Dot product: -0.742781
    • Face normal: [-0.000, -0.000, -1.000]
    • 2D Polygon: (0.0,0.0) → (-7.5,26.8) → (25.7,26.8) → (33.2,0.0)
  Face A8 (Face_8):
    • Area: 297.11
    • Vertices: 4
    • Dot product: -0.371391
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (0.0,0.0) → (33.2,0.0) → (23.3,-8.9) → (-10.0,-8.9)
  Face A9 (Face_9):
    • Area: 26.74
    • Vertices: 4
    • Dot product: -0.557086
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (11.8,5.4) → (7.8,1.8) → (6.3,7.2) → (10.3,10.7)
  Face A10 (Face_10):
    • Area: 334.25
    • Vertices: 4
    • Dot product: 0.557086
    • Face normal: [1.000, 0.000, -0.000]
    • 2D Polygon: (23.3,-8.9) → (33.2,0.0) → (25.7,26.8) → (15.8,17.9)
  Face A11 (Face_11):
    • Area: 33.43
    • Vertices: 4
    • Dot product: 0.557086
    • Face normal: [1.000, 0.000, -0.000]
    • 2D Polygon: (5.4,5.8) → (11.4,11.2) → (10.2,15.7) → (4.2,10.3)
  Face A12 (Face_12):
    • Area: 22.28
    • Vertices: 4
    • Dot product: 0.371391
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (15.6,11.2) → (11.4,11.2) → (5.4,5.8) → (9.6,5.8)
  Face A13 (Face_13):
    • Area: 33.43
    • Vertices: 4
    • Dot product: -0.557086
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (15.6,11.2) → (9.6,5.8) → (8.3,10.3) → (14.3,15.7)
  Face A14 (Face_14):
    • Area: 22.28
    • Vertices: 4
    • Dot product: -0.371391
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (10.2,15.7) → (14.3,15.7) → (8.3,10.3) → (4.2,10.3)
============================================================
ARRAY A DISPLAY COMPLETE - NOW STARTING HISTORIC ALGORITHM
============================================================
Moved Face_1 from array_A to array_B as seed

Processing Face_2 (area: 779.92)
  → Intersection with Face_1 (area: 202.78)
    → Depths: Pi=28.690, Pj=15.227
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 104.73
  → Added Face_2 to array_B

Processing Face_3 (area: 74.28)
  → Intersection with Modified_Face_1 (area: 35.65)
    → Depths: Pi=19.684, Pj=8.913
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 69.08
  → Intersection with Face_2 (area: 8.91)
    → Depths: Pi=29.433, Pj=34.818
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 65.36
  → Added Modified_Face_3 to array_B

Processing Face_4 (area: 92.85)
  → Intersection with Modified_Modified_Face_1 (area: 13.37)
    → Depths: Pi=16.248, Pj=8.171
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 55.71
  → Intersection with Face_2 (area: 66.29)
    → Depths: Pi=19.637, Pj=30.408
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 26.55
  → Added Modified_Face_4 to array_B

Processing Face_5 (area: 74.28)
  → Intersection with Face_2 (area: 74.28)
    → Depths: Pi=25.533, Pj=30.918
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_6 (area: 297.11)
  → Intersection with Modified_Modified_Modified_Face_1 (area: 55.71)
    → Depths: Pi=20.659, Pj=13.927
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_6 to array_B

Processing Face_7 (area: 872.77)
  → Intersection with Face_2 (area: 308.25)
    → Depths: Pi=10.770, Pj=37.696
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 564.51
  → Intersection with Modified_Face_3 (area: 29.71)
    → Depths: Pi=4.271, Pj=25.812
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 534.80
  → Intersection with Modified_Face_4 (area: 13.18)
    → Depths: Pi=5.060, Pj=21.216
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 521.62
  → Intersection with Face_6 (area: 241.40)
    → Depths: Pi=18.337, Pj=31.800
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 280.21
  → Added Modified_Face_7 to array_B

Processing Face_8 (area: 297.11)
  → Intersection with Face_2 (area: 241.40)
    → Depths: Pi=16.480, Pj=29.943
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 55.71
  → Added Modified_Face_8 to array_B

Processing Face_9 (area: 26.74)
  → Intersection with Face_2 (area: 26.74)
    → Depths: Pi=31.383, Pj=36.768
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_10 (area: 334.25)
  → Intersection with Modified_Face_7 (area: 278.54)
    → Depths: Pi=35.282, Pj=21.819
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 1.67
  → Intersection with Modified_Face_8 (area: 55.71)
    → Depths: Pi=34.354, Pj=27.622
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_10 to array_B

Processing Face_11 (area: 33.43)
    🔍 TRACKING FACE 11: Starting processing
    🔍 Face 11 dot product: 0.5570860145311556
    🔍 Face 11 normal: [ 1.  0. -0.]
  → Intersection with Face_2 (area: 32.31)
    → Depths: Pi=17.641, Pj=41.201
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 1.11
  → Intersection with Modified_Modified_Face_7 (area: 1.11)
    → Depths: Pi=23.026, Pj=7.544
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 0.56
  → Added Modified_Face_11 to array_B
  🔍 TRACKING FACE 11: Added to array_B
  🔍 Face 11 area: 1.11
  🔍 Face 11 dot product: 0.5570860145311556

Processing Face_12 (area: 22.28)
  → Intersection with Face_2 (area: 21.73)
    → Depths: Pi=19.498, Pj=39.692
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 0.56
  → Intersection with Modified_Modified_Modified_Face_7 (area: 0.56)
    → Depths: Pi=22.771, Pj=7.962
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Modified_Face_12 to array_B

Processing Face_13 (area: 33.43)
  → Intersection with Face_2 (area: 33.43)
    → Depths: Pi=22.562, Pj=41.410
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_14 (area: 22.28)
  → Intersection with Face_2 (area: 22.28)
    → Depths: Pi=22.098, Pj=40.946
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Step 3: Applying final dot product classification...

============================================================
ENHANCED CLASSIFICATION COMPLETE
============================================================
Array A (processed): 0 faces (all processed)
Array B (visible): 7 faces
Array C (hidden+intersections): 21 faces
Total: 28 faces
[DEBUG] Number of visible polygons: 7
[DEBUG] Number of hidden polygons: 21
[DEBUG] Plotting four views (top, side, front, isometric)
  Traversing BRep topology: Solid -> Shells -> Faces -> Wires -> Edges -> Vertices
  Found 1 shells in solid
  
Shell 1:
    Face 1:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (0.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 1
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,20.0)
              Edge 1: vertex (0.0,12.0,20.0)
              Edge 2: vertex (0.0,12.0,12.0)
              Edge 3: vertex (0.0,18.0,12.0)
              Edge 4: vertex (0.0,18.0,20.0)
              Edge 5: vertex (0.0,30.0,20.0)
              Edge 6: vertex (0.0,30.0,0.0)
              Edge 7: vertex (0.0,0.0,0.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,20.0) → (0.0,12.0,20.0) → (0.0,12.0,12.0) → (0.0,18.0,12.0) → (0.0,18.0,20.0) → (0.0,30.0,20.0) → (0.0,30.0,0.0) → (0.0,0.0,0.0) → (0.0,0.0,20.0)
        Co-linearity Analysis for Face 1:
          Co-linear vertices found: 7-8-0
            V7: (0.000, 0.000, 0.000)
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            V1: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ Z-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 2:
        Face orientation: 0
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 20.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 1 wires in face 2
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,12.0,20.0)
              Edge 1: vertex (0.0,0.0,20.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
              Edge 4: vertex (0.0,30.0,20.0)
              Edge 5: vertex (0.0,18.0,20.0)
              Edge 6: vertex (25.0,18.0,20.0)
              Edge 7: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,12.0,20.0) → (0.0,0.0,20.0) → (40.0,0.0,20.0) → (40.0,30.0,20.0) → (0.0,30.0,20.0) → (0.0,18.0,20.0) → (25.0,18.0,20.0) → (25.0,12.0,20.0) → (0.0,12.0,20.0)
        Co-linearity Analysis for Face 2:
          Co-linear vertices found: 7-8-0
            V7: (25.000, 12.000, 20.000)
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            V1: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ X-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 3:
        Face orientation: 0
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 12.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 3
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (0.0,12.0,20.0)
              Edge 3: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (0.0,12.0,12.0) → (0.0,12.0,20.0) → (25.0,12.0,20.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 3:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 12.000, 20.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 4:
        Face orientation: 0
        Parameter bounds: U[0.000, 25.000], V[0.000, 6.000]
        Using parameters: U=12.500, V=3.000
        Surface point: (12.500, 15.000, 12.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 2 wires in face 4
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (25.0,12.0,12.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (0.0,12.0,12.0) → (25.0,12.0,12.0) → (25.0,18.0,12.0) → (0.0,18.0,12.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,17.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,17.5,12.0) → (22.5,17.5,12.0) → (22.5,12.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 4:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 5:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 18.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 5
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (25.0,18.0,12.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (0.0,18.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (25.0,18.0,12.0) → (25.0,18.0,20.0) → (0.0,18.0,20.0) → (0.0,18.0,12.0)
        Co-linearity Analysis for Face 5:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 18.000, 20.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (25.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 6:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 30.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 6
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,30.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (0.0,30.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,30.0,0.0) → (0.0,30.0,0.0) → (0.0,30.0,20.0) → (40.0,30.0,20.0) → (40.0,30.0,0.0)
        Co-linearity Analysis for Face 6:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 7:
        Face orientation: 1
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 0.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-0.000000, -0.000000, -1.000000]
      Found 2 wires in face 7
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,0.0,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (0.0,30.0,0.0) → (40.0,30.0,0.0) → (40.0,0.0,0.0) → (0.0,0.0,0.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (22.5,12.5,0.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (17.5,12.5,0.0) → (22.5,12.5,0.0) → (22.5,17.5,0.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 7:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 0.000, 0.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 8:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 0.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 8
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (0.0,0.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (40.0,0.0,0.0) → (40.0,0.0,20.0) → (0.0,0.0,20.0) → (0.0,0.0,0.0)
        Co-linearity Analysis for Face 8:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 0.000, 20.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 9:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[-6.000, 0.000]
        Using parameters: U=4.000, V=-3.000
        Surface point: (25.000, 15.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 9
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (25.0,12.0,20.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (25.0,12.0,20.0) → (25.0,18.0,20.0) → (25.0,18.0,12.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 9:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (25.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 10:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (40.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 10
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,0.0,20.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,0.0,20.0) → (40.0,0.0,0.0) → (40.0,30.0,0.0) → (40.0,30.0,20.0) → (40.0,0.0,20.0)
        Co-linearity Analysis for Face 10:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 11:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (17.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 11
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,17.5,0.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,12.5,0.0) → (17.5,17.5,0.0) → (17.5,17.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 11:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 12:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 12.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 12
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,12.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (17.5,12.5,0.0) → (17.5,12.5,12.0) → (22.5,12.5,12.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 12:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 12.500, 12.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 13:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (22.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 13
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (22.5,12.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (22.5,12.5,12.0) → (22.5,17.5,12.0) → (22.5,17.5,0.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 13:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 17.500, 0.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (22.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 14:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 17.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 14
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (22.5,17.5,0.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (22.5,17.5,0.0) → (22.5,17.5,12.0) → (17.5,17.5,12.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 14:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            V1: (22.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
  
✓ Successfully extracted 14 faces from 1 shells

============================================================
ENHANCED FACE CLASSIFICATION WITH HISTORIC ALGORITHM
============================================================
Unit projection normal: [0.000000, 0.000000, 1.000000]

Step 1: Initial classification and polygon projection...
Face F1: dot_product=0.000
    → Creating polygon from 9 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F2: dot_product=1.000
    → Creating polygon from 9 vertices
    → Valid polygon created with 8 vertices
  → Added Face_2 (area: 1050.00)
Face F3: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F4: dot_product=1.000
  → Added Face_4 (area: 125.00) with 1 holes
Face F5: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F6: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F7: dot_product=-1.000
  → Added Face_7 (area: 1175.00) with 1 holes
Face F8: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F9: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F10: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F11: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F12: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F13: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F14: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is

Step 2: Starting historic polygon classification algorithm...
Initial array_A: 3 polygons

SUMMARY: Hidden polygons (Array_C) for Top View:

============================================================
ARRAY A - INITIAL FACE CLASSIFICATION (BEFORE SORTING)
============================================================
  Face A1 (Face_2):
    • Area: 1050.00
    • Vertices: 8
    • Dot product: 1.000000
    • Face normal: [0.000, 0.000, 1.000]
    • 2D Polygon: (0.0,12.0) → (0.0,0.0) → (40.0,0.0) → (40.0,30.0) → (0.0,30.0) → (0.0,18.0) → (25.0,18.0) → (25.0,12.0)
  Face A2 (Face_4):
    • Area: 125.00
    • Vertices: 4
    • Dot product: 1.000000
    • Face normal: [0.000, 0.000, 1.000]
    • 2D Polygon: (0.0,18.0) → (0.0,12.0) → (25.0,12.0) → (25.0,18.0)
  Face A3 (Face_7):
    • Area: 1175.00
    • Vertices: 4
    • Dot product: -1.000000
    • Face normal: [-0.000, -0.000, -1.000]
    • 2D Polygon: (0.0,0.0) → (0.0,30.0) → (40.0,30.0) → (40.0,0.0)
============================================================
ARRAY A DISPLAY COMPLETE - NOW STARTING HISTORIC ALGORITHM
============================================================
Moved Face_2 from array_A to array_B as seed

Processing Face_4 (area: 125.00)
  → Added Face_4 to array_B

Processing Face_7 (area: 1175.00)
  → Intersection with Face_2 (area: 1050.00)
    → Depths: Pi=0.000, Pj=20.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 125.00
  → Intersection with Face_4 (area: 125.00)
    → Depths: Pi=0.000, Pj=12.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Step 3: Applying final dot product classification...

============================================================
ENHANCED CLASSIFICATION COMPLETE
============================================================
Array A (processed): 0 faces (all processed)
Array B (visible): 2 faces
Array C (hidden+intersections): 2 faces
Total: 4 faces
[DEBUG] Top View: 2 visible, 2 hidden polygons
  Traversing BRep topology: Solid -> Shells -> Faces -> Wires -> Edges -> Vertices
  Found 1 shells in solid
  
Shell 1:
    Face 1:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (0.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 1
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,20.0)
              Edge 1: vertex (0.0,12.0,20.0)
              Edge 2: vertex (0.0,12.0,12.0)
              Edge 3: vertex (0.0,18.0,12.0)
              Edge 4: vertex (0.0,18.0,20.0)
              Edge 5: vertex (0.0,30.0,20.0)
              Edge 6: vertex (0.0,30.0,0.0)
              Edge 7: vertex (0.0,0.0,0.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,20.0) → (0.0,12.0,20.0) → (0.0,12.0,12.0) → (0.0,18.0,12.0) → (0.0,18.0,20.0) → (0.0,30.0,20.0) → (0.0,30.0,0.0) → (0.0,0.0,0.0) → (0.0,0.0,20.0)
        Co-linearity Analysis for Face 1:
          Co-linear vertices found: 7-8-0
            V7: (0.000, 0.000, 0.000)
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            V1: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ Z-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 2:
        Face orientation: 0
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 20.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 1 wires in face 2
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,12.0,20.0)
              Edge 1: vertex (0.0,0.0,20.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
              Edge 4: vertex (0.0,30.0,20.0)
              Edge 5: vertex (0.0,18.0,20.0)
              Edge 6: vertex (25.0,18.0,20.0)
              Edge 7: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,12.0,20.0) → (0.0,0.0,20.0) → (40.0,0.0,20.0) → (40.0,30.0,20.0) → (0.0,30.0,20.0) → (0.0,18.0,20.0) → (25.0,18.0,20.0) → (25.0,12.0,20.0) → (0.0,12.0,20.0)
        Co-linearity Analysis for Face 2:
          Co-linear vertices found: 7-8-0
            V7: (25.000, 12.000, 20.000)
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            V1: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ X-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 3:
        Face orientation: 0
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 12.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 3
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (0.0,12.0,20.0)
              Edge 3: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (0.0,12.0,12.0) → (0.0,12.0,20.0) → (25.0,12.0,20.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 3:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 12.000, 20.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 4:
        Face orientation: 0
        Parameter bounds: U[0.000, 25.000], V[0.000, 6.000]
        Using parameters: U=12.500, V=3.000
        Surface point: (12.500, 15.000, 12.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 2 wires in face 4
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (25.0,12.0,12.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (0.0,12.0,12.0) → (25.0,12.0,12.0) → (25.0,18.0,12.0) → (0.0,18.0,12.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,17.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,17.5,12.0) → (22.5,17.5,12.0) → (22.5,12.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 4:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 5:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 18.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 5
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (25.0,18.0,12.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (0.0,18.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (25.0,18.0,12.0) → (25.0,18.0,20.0) → (0.0,18.0,20.0) → (0.0,18.0,12.0)
        Co-linearity Analysis for Face 5:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 18.000, 20.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (25.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 6:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 30.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 6
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,30.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (0.0,30.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,30.0,0.0) → (0.0,30.0,0.0) → (0.0,30.0,20.0) → (40.0,30.0,20.0) → (40.0,30.0,0.0)
        Co-linearity Analysis for Face 6:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 7:
        Face orientation: 1
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 0.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-0.000000, -0.000000, -1.000000]
      Found 2 wires in face 7
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,0.0,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (0.0,30.0,0.0) → (40.0,30.0,0.0) → (40.0,0.0,0.0) → (0.0,0.0,0.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (22.5,12.5,0.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (17.5,12.5,0.0) → (22.5,12.5,0.0) → (22.5,17.5,0.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 7:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 0.000, 0.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 8:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 0.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 8
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (0.0,0.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (40.0,0.0,0.0) → (40.0,0.0,20.0) → (0.0,0.0,20.0) → (0.0,0.0,0.0)
        Co-linearity Analysis for Face 8:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 0.000, 20.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 9:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[-6.000, 0.000]
        Using parameters: U=4.000, V=-3.000
        Surface point: (25.000, 15.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 9
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (25.0,12.0,20.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (25.0,12.0,20.0) → (25.0,18.0,20.0) → (25.0,18.0,12.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 9:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (25.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 10:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (40.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 10
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,0.0,20.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,0.0,20.0) → (40.0,0.0,0.0) → (40.0,30.0,0.0) → (40.0,30.0,20.0) → (40.0,0.0,20.0)
        Co-linearity Analysis for Face 10:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 11:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (17.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 11
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,17.5,0.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,12.5,0.0) → (17.5,17.5,0.0) → (17.5,17.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 11:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 12:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 12.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 12
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,12.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (17.5,12.5,0.0) → (17.5,12.5,12.0) → (22.5,12.5,12.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 12:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 12.500, 12.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 13:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (22.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 13
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (22.5,12.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (22.5,12.5,12.0) → (22.5,17.5,12.0) → (22.5,17.5,0.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 13:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 17.500, 0.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (22.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 14:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 17.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 14
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (22.5,17.5,0.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (22.5,17.5,0.0) → (22.5,17.5,12.0) → (17.5,17.5,12.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 14:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            V1: (22.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
  
✓ Successfully extracted 14 faces from 1 shells

============================================================
ENHANCED FACE CLASSIFICATION WITH HISTORIC ALGORITHM
============================================================
Unit projection normal: [0.557086, 0.371391, 0.742781]

Step 1: Initial classification and polygon projection...
Face F1: dot_product=-0.557
    → Creating polygon from 9 vertices
    → Valid polygon created with 8 vertices
  → Added Face_1 (area: 307.51)
Face F2: dot_product=0.743
    → Creating polygon from 9 vertices
    → Valid polygon created with 8 vertices
  → Added Face_2 (area: 779.92)
Face F3: dot_product=0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_3 (area: 74.28)
Face F4: dot_product=0.743
  → Added Face_4 (area: 92.85) with 1 holes
Face F5: dot_product=-0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_5 (area: 74.28)
Face F6: dot_product=0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_6 (area: 297.11)
Face F7: dot_product=-0.743
  → Added Face_7 (area: 872.77) with 1 holes
Face F8: dot_product=-0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_8 (area: 297.11)
Face F9: dot_product=-0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_9 (area: 26.74)
Face F10: dot_product=0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_10 (area: 334.25)
Face F11: dot_product=0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_11 (area: 33.43)
Face F12: dot_product=0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_12 (area: 22.28)
Face F13: dot_product=-0.557
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_13 (area: 33.43)
Face F14: dot_product=-0.371
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_14 (area: 22.28)

Step 2: Starting historic polygon classification algorithm...
Initial array_A: 14 polygons

============================================================
ARRAY A - INITIAL FACE CLASSIFICATION (BEFORE SORTING)
============================================================
  Face A1 (Face_1):
    • Area: 307.51
    • Vertices: 8
    • Dot product: -0.557086
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (-10.0,-8.9) → (-13.0,1.8) → (-9.0,5.4) → (-10.5,10.7) → (-14.4,7.2) → (-17.4,17.9) → (-7.5,26.8) → (0.0,0.0)
  Face A2 (Face_2):
    • Area: 779.92
    • Vertices: 8
    • Dot product: 0.742781
    • Face normal: [0.000, 0.000, 1.000]
    • 2D Polygon: (-13.0,1.8) → (-10.0,-8.9) → (23.3,-8.9) → (15.8,17.9) → (-17.4,17.9) → (-14.4,7.2) → (6.3,7.2) → (7.8,1.8)
  Face A3 (Face_3):
    • Area: 74.28
    • Vertices: 4
    • Dot product: 0.371391
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (11.8,5.4) → (-9.0,5.4) → (-13.0,1.8) → (7.8,1.8)
  Face A4 (Face_4):
    • Area: 92.85
    • Vertices: 4
    • Dot product: 0.742781
    • Face normal: [0.000, 0.000, 1.000]
    • 2D Polygon: (-10.5,10.7) → (-9.0,5.4) → (11.8,5.4) → (10.3,10.7)
  Face A5 (Face_5):
    • Area: 74.28
    • Vertices: 4
    • Dot product: -0.371391
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (-10.5,10.7) → (10.3,10.7) → (6.3,7.2) → (-14.4,7.2)
  Face A6 (Face_6):
    • Area: 297.11
    • Vertices: 4
    • Dot product: 0.371391
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (25.7,26.8) → (-7.5,26.8) → (-17.4,17.9) → (15.8,17.9)
  Face A7 (Face_7):
    • Area: 872.77
    • Vertices: 4
    • Dot product: -0.742781
    • Face normal: [-0.000, -0.000, -1.000]
    • 2D Polygon: (0.0,0.0) → (-7.5,26.8) → (25.7,26.8) → (33.2,0.0)
  Face A8 (Face_8):
    • Area: 297.11
    • Vertices: 4
    • Dot product: -0.371391
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (0.0,0.0) → (33.2,0.0) → (23.3,-8.9) → (-10.0,-8.9)
  Face A9 (Face_9):
    • Area: 26.74
    • Vertices: 4
    • Dot product: -0.557086
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (11.8,5.4) → (7.8,1.8) → (6.3,7.2) → (10.3,10.7)
  Face A10 (Face_10):
    • Area: 334.25
    • Vertices: 4
    • Dot product: 0.557086
    • Face normal: [1.000, 0.000, -0.000]
    • 2D Polygon: (23.3,-8.9) → (33.2,0.0) → (25.7,26.8) → (15.8,17.9)
  Face A11 (Face_11):
    • Area: 33.43
    • Vertices: 4
    • Dot product: 0.557086
    • Face normal: [1.000, 0.000, -0.000]
    • 2D Polygon: (5.4,5.8) → (11.4,11.2) → (10.2,15.7) → (4.2,10.3)
  Face A12 (Face_12):
    • Area: 22.28
    • Vertices: 4
    • Dot product: 0.371391
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (15.6,11.2) → (11.4,11.2) → (5.4,5.8) → (9.6,5.8)
  Face A13 (Face_13):
    • Area: 33.43
    • Vertices: 4
    • Dot product: -0.557086
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (15.6,11.2) → (9.6,5.8) → (8.3,10.3) → (14.3,15.7)
  Face A14 (Face_14):
    • Area: 22.28
    • Vertices: 4
    • Dot product: -0.371391
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (10.2,15.7) → (14.3,15.7) → (8.3,10.3) → (4.2,10.3)
============================================================
ARRAY A DISPLAY COMPLETE - NOW STARTING HISTORIC ALGORITHM
============================================================
Moved Face_1 from array_A to array_B as seed

Processing Face_2 (area: 779.92)
  → Intersection with Face_1 (area: 202.78)
    → Depths: Pi=28.690, Pj=15.227
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 104.73
  → Added Face_2 to array_B

Processing Face_3 (area: 74.28)
  → Intersection with Modified_Face_1 (area: 35.65)
    → Depths: Pi=19.684, Pj=8.913
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 69.08
  → Intersection with Face_2 (area: 8.91)
    → Depths: Pi=29.433, Pj=34.818
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 65.36
  → Added Modified_Face_3 to array_B

Processing Face_4 (area: 92.85)
  → Intersection with Modified_Modified_Face_1 (area: 13.37)
    → Depths: Pi=16.248, Pj=8.171
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 55.71
  → Intersection with Face_2 (area: 66.29)
    → Depths: Pi=19.637, Pj=30.408
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 26.55
  → Added Modified_Face_4 to array_B

Processing Face_5 (area: 74.28)
  → Intersection with Face_2 (area: 74.28)
    → Depths: Pi=25.533, Pj=30.918
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_6 (area: 297.11)
  → Intersection with Modified_Modified_Modified_Face_1 (area: 55.71)
    → Depths: Pi=20.659, Pj=13.927
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_6 to array_B

Processing Face_7 (area: 872.77)
  → Intersection with Face_2 (area: 308.25)
    → Depths: Pi=10.770, Pj=37.696
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 564.51
  → Intersection with Modified_Face_3 (area: 29.71)
    → Depths: Pi=4.271, Pj=25.812
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 534.80
  → Intersection with Modified_Face_4 (area: 13.18)
    → Depths: Pi=5.060, Pj=21.216
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 521.62
  → Intersection with Face_6 (area: 241.40)
    → Depths: Pi=18.337, Pj=31.800
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 280.21
  → Added Modified_Face_7 to array_B

Processing Face_8 (area: 297.11)
  → Intersection with Face_2 (area: 241.40)
    → Depths: Pi=16.480, Pj=29.943
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 55.71
  → Added Modified_Face_8 to array_B

Processing Face_9 (area: 26.74)
  → Intersection with Face_2 (area: 26.74)
    → Depths: Pi=31.383, Pj=36.768
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_10 (area: 334.25)
  → Intersection with Modified_Face_7 (area: 278.54)
    → Depths: Pi=35.282, Pj=21.819
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 1.67
  → Intersection with Modified_Face_8 (area: 55.71)
    → Depths: Pi=34.354, Pj=27.622
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_10 to array_B

Processing Face_11 (area: 33.43)
    🔍 TRACKING FACE 11: Starting processing
    🔍 Face 11 dot product: 0.5570860145311556
    🔍 Face 11 normal: [ 1.  0. -0.]
  → Intersection with Face_2 (area: 32.31)
    → Depths: Pi=17.641, Pj=41.201
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 1.11
  → Intersection with Modified_Modified_Face_7 (area: 1.11)
    → Depths: Pi=23.026, Pj=7.544
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Updated Pj area: 0.56
  → Added Modified_Face_11 to array_B
  🔍 TRACKING FACE 11: Added to array_B
  🔍 Face 11 area: 1.11
  🔍 Face 11 dot product: 0.5570860145311556

Processing Face_12 (area: 22.28)
  → Intersection with Face_2 (area: 21.73)
    → Depths: Pi=19.498, Pj=39.692
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Updated Pi area: 0.56
  → Intersection with Modified_Modified_Modified_Face_7 (area: 0.56)
    → Depths: Pi=22.771, Pj=7.962
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Modified_Face_12 to array_B

Processing Face_13 (area: 33.43)
  → Intersection with Face_2 (area: 33.43)
    → Depths: Pi=22.562, Pj=41.410
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_14 (area: 22.28)
  → Intersection with Face_2 (area: 22.28)
    → Depths: Pi=22.098, Pj=40.946
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Step 3: Applying final dot product classification...

============================================================
ENHANCED CLASSIFICATION COMPLETE
============================================================
Array A (processed): 0 faces (all processed)
Array B (visible): 7 faces
Array C (hidden+intersections): 21 faces
Total: 28 faces
[DEBUG] Isometric View: 7 visible, 21 hidden polygons
  Traversing BRep topology: Solid -> Shells -> Faces -> Wires -> Edges -> Vertices
  Found 1 shells in solid
  
Shell 1:
    Face 1:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (0.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 1
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,20.0)
              Edge 1: vertex (0.0,12.0,20.0)
              Edge 2: vertex (0.0,12.0,12.0)
              Edge 3: vertex (0.0,18.0,12.0)
              Edge 4: vertex (0.0,18.0,20.0)
              Edge 5: vertex (0.0,30.0,20.0)
              Edge 6: vertex (0.0,30.0,0.0)
              Edge 7: vertex (0.0,0.0,0.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,20.0) → (0.0,12.0,20.0) → (0.0,12.0,12.0) → (0.0,18.0,12.0) → (0.0,18.0,20.0) → (0.0,30.0,20.0) → (0.0,30.0,0.0) → (0.0,0.0,0.0) → (0.0,0.0,20.0)
        Co-linearity Analysis for Face 1:
          Co-linear vertices found: 7-8-0
            V7: (0.000, 0.000, 0.000)
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            V1: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ Z-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 2:
        Face orientation: 0
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 20.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 1 wires in face 2
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,12.0,20.0)
              Edge 1: vertex (0.0,0.0,20.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
              Edge 4: vertex (0.0,30.0,20.0)
              Edge 5: vertex (0.0,18.0,20.0)
              Edge 6: vertex (25.0,18.0,20.0)
              Edge 7: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,12.0,20.0) → (0.0,0.0,20.0) → (40.0,0.0,20.0) → (40.0,30.0,20.0) → (0.0,30.0,20.0) → (0.0,18.0,20.0) → (25.0,18.0,20.0) → (25.0,12.0,20.0) → (0.0,12.0,20.0)
        Co-linearity Analysis for Face 2:
          Co-linear vertices found: 7-8-0
            V7: (25.000, 12.000, 20.000)
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            V1: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ X-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 3:
        Face orientation: 0
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 12.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 3
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (0.0,12.0,20.0)
              Edge 3: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (0.0,12.0,12.0) → (0.0,12.0,20.0) → (25.0,12.0,20.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 3:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 12.000, 20.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 4:
        Face orientation: 0
        Parameter bounds: U[0.000, 25.000], V[0.000, 6.000]
        Using parameters: U=12.500, V=3.000
        Surface point: (12.500, 15.000, 12.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 2 wires in face 4
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (25.0,12.0,12.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (0.0,12.0,12.0) → (25.0,12.0,12.0) → (25.0,18.0,12.0) → (0.0,18.0,12.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,17.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,17.5,12.0) → (22.5,17.5,12.0) → (22.5,12.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 4:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 5:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 18.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 5
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (25.0,18.0,12.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (0.0,18.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (25.0,18.0,12.0) → (25.0,18.0,20.0) → (0.0,18.0,20.0) → (0.0,18.0,12.0)
        Co-linearity Analysis for Face 5:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 18.000, 20.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (25.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 6:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 30.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 6
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,30.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (0.0,30.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,30.0,0.0) → (0.0,30.0,0.0) → (0.0,30.0,20.0) → (40.0,30.0,20.0) → (40.0,30.0,0.0)
        Co-linearity Analysis for Face 6:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 7:
        Face orientation: 1
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 0.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-0.000000, -0.000000, -1.000000]
      Found 2 wires in face 7
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,0.0,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (0.0,30.0,0.0) → (40.0,30.0,0.0) → (40.0,0.0,0.0) → (0.0,0.0,0.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (22.5,12.5,0.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (17.5,12.5,0.0) → (22.5,12.5,0.0) → (22.5,17.5,0.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 7:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 0.000, 0.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 8:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 0.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 8
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (0.0,0.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (40.0,0.0,0.0) → (40.0,0.0,20.0) → (0.0,0.0,20.0) → (0.0,0.0,0.0)
        Co-linearity Analysis for Face 8:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 0.000, 20.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 9:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[-6.000, 0.000]
        Using parameters: U=4.000, V=-3.000
        Surface point: (25.000, 15.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 9
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (25.0,12.0,20.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (25.0,12.0,20.0) → (25.0,18.0,20.0) → (25.0,18.0,12.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 9:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (25.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 10:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (40.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 10
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,0.0,20.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,0.0,20.0) → (40.0,0.0,0.0) → (40.0,30.0,0.0) → (40.0,30.0,20.0) → (40.0,0.0,20.0)
        Co-linearity Analysis for Face 10:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 11:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (17.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 11
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,17.5,0.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,12.5,0.0) → (17.5,17.5,0.0) → (17.5,17.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 11:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 12:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 12.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 12
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,12.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (17.5,12.5,0.0) → (17.5,12.5,12.0) → (22.5,12.5,12.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 12:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 12.500, 12.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 13:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (22.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 13
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (22.5,12.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (22.5,12.5,12.0) → (22.5,17.5,12.0) → (22.5,17.5,0.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 13:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 17.500, 0.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (22.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 14:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 17.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 14
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (22.5,17.5,0.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (22.5,17.5,0.0) → (22.5,17.5,12.0) → (17.5,17.5,12.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 14:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            V1: (22.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
  
✓ Successfully extracted 14 faces from 1 shells

============================================================
ENHANCED FACE CLASSIFICATION WITH HISTORIC ALGORITHM
============================================================
Unit projection normal: [0.000000, 1.000000, 0.000000]

Step 1: Initial classification and polygon projection...
Face F1: dot_product=0.000
    → Creating polygon from 9 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F2: dot_product=0.000
    → Creating polygon from 9 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F3: dot_product=1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_3 (area: 200.00)
Face F4: dot_product=0.000
Face F5: dot_product=-1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_5 (area: 200.00)
Face F6: dot_product=1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_6 (area: 800.00)
Face F7: dot_product=0.000
Face F8: dot_product=-1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_8 (area: 800.00)
Face F9: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F10: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F11: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F12: dot_product=1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_12 (area: 60.00)
Face F13: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F14: dot_product=-1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_14 (area: 60.00)

Step 2: Starting historic polygon classification algorithm...
Initial array_A: 6 polygons

============================================================
ARRAY A - INITIAL FACE CLASSIFICATION (BEFORE SORTING)
============================================================
  Face A1 (Face_3):
    • Area: 200.00
    • Vertices: 4
    • Dot product: 1.000000
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (25.0,-12.0) → (0.0,-12.0) → (0.0,-20.0) → (25.0,-20.0)
  Face A2 (Face_5):
    • Area: 200.00
    • Vertices: 4
    • Dot product: -1.000000
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (0.0,-12.0) → (25.0,-12.0) → (25.0,-20.0) → (0.0,-20.0)
  Face A3 (Face_6):
    • Area: 800.00
    • Vertices: 4
    • Dot product: 1.000000
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (40.0,0.0) → (0.0,0.0) → (0.0,-20.0) → (40.0,-20.0)
  Face A4 (Face_8):
    • Area: 800.00
    • Vertices: 4
    • Dot product: -1.000000
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (0.0,0.0) → (40.0,0.0) → (40.0,-20.0) → (0.0,-20.0)
  Face A5 (Face_12):
    • Area: 60.00
    • Vertices: 4
    • Dot product: 1.000000
    • Face normal: [-0.000, 1.000, 0.000]
    • 2D Polygon: (22.5,0.0) → (17.5,0.0) → (17.5,-12.0) → (22.5,-12.0)
  Face A6 (Face_14):
    • Area: 60.00
    • Vertices: 4
    • Dot product: -1.000000
    • Face normal: [0.000, -1.000, -0.000]
    • 2D Polygon: (17.5,0.0) → (22.5,0.0) → (22.5,-12.0) → (17.5,-12.0)
============================================================
ARRAY A DISPLAY COMPLETE - NOW STARTING HISTORIC ALGORITHM
============================================================
Moved Face_3 from array_A to array_B as seed

Processing Face_5 (area: 200.00)
  → Intersection with Face_3 (area: 200.00)
    → Depths: Pi=18.000, Pj=12.000
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_5 to array_B

Processing Face_6 (area: 800.00)
  → Intersection with Face_5 (area: 200.00)
    → Depths: Pi=30.000, Pj=18.000
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_6 to array_B

Processing Face_8 (area: 800.00)
  → Intersection with Face_6 (area: 800.00)
    → Depths: Pi=0.000, Pj=30.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_12 (area: 60.00)
  → Intersection with Face_6 (area: 60.00)
    → Depths: Pi=12.500, Pj=30.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_14 (area: 60.00)
  → Intersection with Face_6 (area: 60.00)
    → Depths: Pi=17.500, Pj=30.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Step 3: Applying final dot product classification...

============================================================
ENHANCED CLASSIFICATION COMPLETE
============================================================
Array A (processed): 0 faces (all processed)
Array B (visible): 1 faces
Array C (hidden+intersections): 5 faces
Total: 6 faces
[DEBUG] Front View: 1 visible, 5 hidden polygons
  Traversing BRep topology: Solid -> Shells -> Faces -> Wires -> Edges -> Vertices
  Found 1 shells in solid
  
Shell 1:
    Face 1:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (0.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 1
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,20.0)
              Edge 1: vertex (0.0,12.0,20.0)
              Edge 2: vertex (0.0,12.0,12.0)
              Edge 3: vertex (0.0,18.0,12.0)
              Edge 4: vertex (0.0,18.0,20.0)
              Edge 5: vertex (0.0,30.0,20.0)
              Edge 6: vertex (0.0,30.0,0.0)
              Edge 7: vertex (0.0,0.0,0.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,20.0) → (0.0,12.0,20.0) → (0.0,12.0,12.0) → (0.0,18.0,12.0) → (0.0,18.0,20.0) → (0.0,30.0,20.0) → (0.0,30.0,0.0) → (0.0,0.0,0.0) → (0.0,0.0,20.0)
        Co-linearity Analysis for Face 1:
          Co-linear vertices found: 7-8-0
            V7: (0.000, 0.000, 0.000)
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 0.000, 20.000)
            V0: (0.000, 0.000, 20.000)
            V1: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ Z-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 2:
        Face orientation: 0
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 20.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 1 wires in face 2
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,12.0,20.0)
              Edge 1: vertex (0.0,0.0,20.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
              Edge 4: vertex (0.0,30.0,20.0)
              Edge 5: vertex (0.0,18.0,20.0)
              Edge 6: vertex (25.0,18.0,20.0)
              Edge 7: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 8 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,12.0,20.0) → (0.0,0.0,20.0) → (40.0,0.0,20.0) → (40.0,30.0,20.0) → (0.0,30.0,20.0) → (0.0,18.0,20.0) → (25.0,18.0,20.0) → (25.0,12.0,20.0) → (0.0,12.0,20.0)
        Co-linearity Analysis for Face 2:
          Co-linear vertices found: 7-8-0
            V7: (25.000, 12.000, 20.000)
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 8-0-1
            V8: (0.000, 12.000, 20.000)
            V0: (0.000, 12.000, 20.000)
            V1: (0.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
          Edge 4-5: ✓ Y-axis aligned (1.000000)
          Edge 5-6: ✓ X-axis aligned (1.000000)
          Edge 6-7: ✓ Y-axis aligned (1.000000)
          Edge 7-8: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 9 outer vertices, 0 cutouts, 9 total vertices
    Face 3:
        Face orientation: 0
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 12.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 3
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (0.0,12.0,20.0)
              Edge 3: vertex (25.0,12.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (0.0,12.0,12.0) → (0.0,12.0,20.0) → (25.0,12.0,20.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 3:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 12.000, 20.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 4:
        Face orientation: 0
        Parameter bounds: U[0.000, 25.000], V[0.000, 6.000]
        Using parameters: U=12.500, V=3.000
        Surface point: (12.500, 15.000, 12.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        Derivative normal: [0.000000, 0.000000, 1.000000]
      Found 2 wires in face 4
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (0.0,12.0,12.0)
              Edge 2: vertex (25.0,12.0,12.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (0.0,12.0,12.0) → (25.0,12.0,12.0) → (25.0,18.0,12.0) → (0.0,18.0,12.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,17.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,17.5,12.0) → (22.5,17.5,12.0) → (22.5,12.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 4:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (0.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 5:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[0.000, 25.000]
        Using parameters: U=4.000, V=12.500
        Surface point: (12.500, 18.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 5
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,18.0,12.0)
              Edge 1: vertex (25.0,18.0,12.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (0.0,18.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,18.0,12.0) → (25.0,18.0,12.0) → (25.0,18.0,20.0) → (0.0,18.0,20.0) → (0.0,18.0,12.0)
        Co-linearity Analysis for Face 5:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 18.000, 20.000)
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 18.000, 12.000)
            V0: (0.000, 18.000, 12.000)
            V1: (25.000, 18.000, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 6:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 30.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 6
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,30.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (0.0,30.0,20.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,30.0,0.0) → (0.0,30.0,0.0) → (0.0,30.0,20.0) → (40.0,30.0,20.0) → (40.0,30.0,0.0)
        Co-linearity Analysis for Face 6:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 30.000, 0.000)
            V0: (40.000, 30.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 7:
        Face orientation: 1
        Parameter bounds: U[0.000, 40.000], V[0.000, 30.000]
        Using parameters: U=20.000, V=15.000
        Surface point: (20.000, 15.000, 0.000)
        dU vector: (1.000, 0.000, -0.000)
        dV vector: (-0.000, 1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-0.000000, -0.000000, -1.000000]
      Found 2 wires in face 7
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (0.0,30.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,0.0,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (0.0,30.0,0.0) → (40.0,30.0,0.0) → (40.0,0.0,0.0) → (0.0,0.0,0.0)
          Traversing Wire 2 edges...
            Wire 2 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (22.5,12.5,0.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (17.5,12.5,0.0) → (22.5,12.5,0.0) → (22.5,17.5,0.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 7:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 0.000, 0.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (0.000, 30.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Y-axis aligned (1.000000)
          Edge 1-2: ✓ X-axis aligned (1.000000)
          Edge 2-3: ✓ Y-axis aligned (1.000000)
          Edge 3-4: ✓ X-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 1 cutouts, 10 total vertices
    Face 8:
        Face orientation: 1
        Parameter bounds: U[0.000, 20.000], V[0.000, 40.000]
        Using parameters: U=10.000, V=20.000
        Surface point: (20.000, 0.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 8
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (0.0,0.0,0.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,0.0,20.0)
              Edge 3: vertex (0.0,0.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (0.0,0.0,0.0) → (40.0,0.0,0.0) → (40.0,0.0,20.0) → (0.0,0.0,20.0) → (0.0,0.0,0.0)
        Co-linearity Analysis for Face 8:
          Co-linear vertices found: 3-4-0
            V3: (0.000, 0.000, 20.000)
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (0.000, 0.000, 0.000)
            V0: (0.000, 0.000, 0.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 9:
        Face orientation: 1
        Parameter bounds: U[0.000, 8.000], V[-6.000, 0.000]
        Using parameters: U=4.000, V=-3.000
        Surface point: (25.000, 15.000, 16.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 9
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (25.0,12.0,12.0)
              Edge 1: vertex (25.0,12.0,20.0)
              Edge 2: vertex (25.0,18.0,20.0)
              Edge 3: vertex (25.0,18.0,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (25.0,12.0,12.0) → (25.0,12.0,20.0) → (25.0,18.0,20.0) → (25.0,18.0,12.0) → (25.0,12.0,12.0)
        Co-linearity Analysis for Face 9:
          Co-linear vertices found: 3-4-0
            V3: (25.000, 18.000, 12.000)
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (25.000, 12.000, 12.000)
            V0: (25.000, 12.000, 12.000)
            V1: (25.000, 12.000, 20.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 10:
        Face orientation: 0
        Parameter bounds: U[0.000, 20.000], V[-30.000, 0.000]
        Using parameters: U=10.000, V=-15.000
        Surface point: (40.000, 15.000, 10.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 10
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (40.0,0.0,20.0)
              Edge 1: vertex (40.0,0.0,0.0)
              Edge 2: vertex (40.0,30.0,0.0)
              Edge 3: vertex (40.0,30.0,20.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (40.0,0.0,20.0) → (40.0,0.0,0.0) → (40.0,30.0,0.0) → (40.0,30.0,20.0) → (40.0,0.0,20.0)
        Co-linearity Analysis for Face 10:
          Co-linear vertices found: 3-4-0
            V3: (40.000, 30.000, 20.000)
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (40.000, 0.000, 20.000)
            V0: (40.000, 0.000, 20.000)
            V1: (40.000, 0.000, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 11:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (17.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        Derivative normal: [1.000000, 0.000000, -0.000000]
      Found 1 wires in face 11
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,12.5,12.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,17.5,0.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,12.5,12.0) → (17.5,12.5,0.0) → (17.5,17.5,0.0) → (17.5,17.5,12.0) → (17.5,12.5,12.0)
        Co-linearity Analysis for Face 11:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 12.500, 12.000)
            V0: (17.500, 12.500, 12.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 12:
        Face orientation: 0
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 12.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        Derivative normal: [-0.000000, 1.000000, 0.000000]
      Found 1 wires in face 12
          Traversing Wire 1 edges...
            Wire 1 orientation: FORWARD
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (17.5,12.5,0.0)
              Edge 2: vertex (17.5,12.5,12.0)
              Edge 3: vertex (22.5,12.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (17.5,12.5,0.0) → (17.5,12.5,12.0) → (22.5,12.5,12.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 12:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 12.500, 12.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (17.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 13:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[-5.000, 0.000]
        Using parameters: U=6.000, V=-2.500
        Surface point: (22.500, 15.000, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (0.000, -1.000, 0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [-1.000000, -0.000000, 0.000000]
      Found 1 wires in face 13
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (22.5,12.5,0.0)
              Edge 1: vertex (22.5,12.5,12.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (22.5,17.5,0.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (22.5,12.5,0.0) → (22.5,12.5,12.0) → (22.5,17.5,12.0) → (22.5,17.5,0.0) → (22.5,12.5,0.0)
        Co-linearity Analysis for Face 13:
          Co-linear vertices found: 3-4-0
            V3: (22.500, 17.500, 0.000)
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (22.500, 12.500, 0.000)
            V0: (22.500, 12.500, 0.000)
            V1: (22.500, 12.500, 12.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ Z-axis aligned (1.000000)
          Edge 1-2: ✓ Y-axis aligned (1.000000)
          Edge 2-3: ✓ Z-axis aligned (1.000000)
          Edge 3-4: ✓ Y-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
    Face 14:
        Face orientation: 1
        Parameter bounds: U[0.000, 12.000], V[0.000, 5.000]
        Using parameters: U=6.000, V=2.500
        Surface point: (20.000, 17.500, 6.000)
        dU vector: (0.000, 0.000, 1.000)
        dV vector: (1.000, 0.000, -0.000)
        REVERSED face - flipping derivative normal
        Derivative normal: [0.000000, -1.000000, -0.000000]
      Found 1 wires in face 14
          Traversing Wire 1 edges...
            Wire 1 orientation: REVERSED
            ✓ Using BRepTools_WireExplorer for proper wire traversal
              Edge 0: vertex (17.5,17.5,0.0)
              Edge 1: vertex (22.5,17.5,0.0)
              Edge 2: vertex (22.5,17.5,12.0)
              Edge 3: vertex (17.5,17.5,12.0)
            ✓ Wire traversal complete: 4 vertices
            Added closing vertex to complete wire loop
            FINAL: (17.5,17.5,0.0) → (22.5,17.5,0.0) → (22.5,17.5,12.0) → (17.5,17.5,12.0) → (17.5,17.5,0.0)
        Co-linearity Analysis for Face 14:
          Co-linear vertices found: 3-4-0
            V3: (17.500, 17.500, 12.000)
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          Co-linear vertices found: 4-0-1
            V4: (17.500, 17.500, 0.000)
            V0: (17.500, 17.500, 0.000)
            V1: (22.500, 17.500, 0.000)
            Cross product magnitude: 0.00000000
          ⚠️  2 co-linear groups found - may cause triangle appearance
        Axis Alignment Analysis:
          Edge 0-1: ✓ X-axis aligned (1.000000)
          Edge 1-2: ✓ Z-axis aligned (1.000000)
          Edge 2-3: ✓ X-axis aligned (1.000000)
          Edge 3-4: ✓ Z-axis aligned (1.000000)
      ✓ Extracted polygon: 5 outer vertices, 0 cutouts, 5 total vertices
  
✓ Successfully extracted 14 faces from 1 shells

============================================================
ENHANCED FACE CLASSIFICATION WITH HISTORIC ALGORITHM
============================================================
Unit projection normal: [1.000000, 0.000000, 0.000000]

Step 1: Initial classification and polygon projection...
Face F1: dot_product=-1.000
    → Creating polygon from 9 vertices
    → Valid polygon created with 8 vertices
  → Added Face_1 (area: 552.00)
Face F2: dot_product=0.000
    → Creating polygon from 9 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F3: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F4: dot_product=0.000
Face F5: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F6: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F7: dot_product=0.000
Face F8: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F9: dot_product=-1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_9 (area: 48.00)
Face F10: dot_product=1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_10 (area: 600.00)
Face F11: dot_product=1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_11 (area: 60.00)
Face F12: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is
Face F13: dot_product=-1.000
    → Creating polygon from 5 vertices
    → Valid polygon created with 4 vertices
  → Added Face_13 (area: 60.00)
Face F14: dot_product=0.000
    → Creating polygon from 5 vertices
    → Polygon is invalid, but allow_invalid=True: storing as-is

Step 2: Starting historic polygon classification algorithm...
Initial array_A: 5 polygons

============================================================
ARRAY A - INITIAL FACE CLASSIFICATION (BEFORE SORTING)
============================================================
  Face A1 (Face_1):
    • Area: 552.00
    • Vertices: 8
    • Dot product: -1.000000
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (0.0,20.0) → (12.0,20.0) → (12.0,12.0) → (18.0,12.0) → (18.0,20.0) → (30.0,20.0) → (30.0,0.0) → (0.0,0.0)
  Face A2 (Face_9):
    • Area: 48.00
    • Vertices: 4
    • Dot product: -1.000000
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (12.0,12.0) → (12.0,20.0) → (18.0,20.0) → (18.0,12.0)
  Face A3 (Face_10):
    • Area: 600.00
    • Vertices: 4
    • Dot product: 1.000000
    • Face normal: [1.000, 0.000, -0.000]
    • 2D Polygon: (0.0,20.0) → (0.0,0.0) → (30.0,0.0) → (30.0,20.0)
  Face A4 (Face_11):
    • Area: 60.00
    • Vertices: 4
    • Dot product: 1.000000
    • Face normal: [1.000, 0.000, -0.000]
    • 2D Polygon: (12.5,12.0) → (12.5,0.0) → (17.5,0.0) → (17.5,12.0)
  Face A5 (Face_13):
    • Area: 60.00
    • Vertices: 4
    • Dot product: -1.000000
    • Face normal: [-1.000, -0.000, 0.000]
    • 2D Polygon: (12.5,0.0) → (12.5,12.0) → (17.5,12.0) → (17.5,0.0)
============================================================
ARRAY A DISPLAY COMPLETE - NOW STARTING HISTORIC ALGORITHM
============================================================
Moved Face_1 from array_A to array_B as seed

Processing Face_9 (area: 48.00)
  → Added Face_9 to array_B

Processing Face_10 (area: 600.00)
  → Intersection with Face_1 (area: 552.00)
    → Depths: Pi=40.000, Pj=0.000
    → Added intersection to array_C
    → Pi farther: modifying Pj = Pj - Pi
    → Removed Pj (empty after subtraction)
  → Added Face_10 to array_B

Processing Face_11 (area: 60.00)
    🔍 TRACKING FACE 11: Starting processing
    🔍 Face 11 dot product: 1.0
    🔍 Face 11 normal: [ 1.  0. -0.]
  → Intersection with Face_10 (area: 60.00)
    → Depths: Pi=17.500, Pj=40.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Processing Face_13 (area: 60.00)
  → Intersection with Face_10 (area: 60.00)
    → Depths: Pi=22.500, Pj=40.000
    → Added intersection to array_C
    → Pj farther: modifying Pi = Pi - Pj
    → Pi consumed (empty after subtraction)

Step 3: Applying final dot product classification...
  → Face_9: dot_product=-1.000 ≤ 0, moving to array_C

============================================================
ENHANCED CLASSIFICATION COMPLETE
============================================================
Array A (processed): 0 faces (all processed)
Array B (visible): 1 faces
Array C (hidden+intersections): 4 faces
Total: 5 faces
[DEBUG] Side View: 1 visible, 4 hidden polygons
